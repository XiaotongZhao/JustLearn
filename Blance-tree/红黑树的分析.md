##平衡二叉树

平衡二叉树的存在主要提供了一种对数据查找的优化方案，线性数据结构如：链表，数组的时间复杂度为O(n),而平衡二叉树的时间复杂度为lg(n)两者会随着n的值逐步提升而产生鲜明的对比，但是一旦涉及插入与删除操作平衡二叉树的就会出现很多问题

如：根节点的左子树完全被删除，如下图：

![image.png](/.attachments/image-115bd689-8a02-4a2a-9480-f1c3004b9b2c.png)

只针对左侧做过多的插入，如下图：

![image.png](/.attachments/image-d3372578-e2c4-40ff-bfb7-ab42acb82105.png)

这两种情况往往会导致平衡二叉树的查询效率逐步降低，只有让当前平衡二叉树“重新平衡”才能够解决以上这两情况所带来的问题，而红黑树可以做到这一点

##红黑树

红黑树是一种，能够让平衡二叉树重新恢复“再平衡”从而衍生出来一种数据结构，通过构建红黑树无论做删除还是插入都可以让其平衡二叉树从新恢复平衡

红黑树必须具备以下五种性质：

1. 每个节点或是红色，或是黑色
2. 根节点是黑色
3. 每个叶结点（null）均为黑色
4. 如果一个节点为红色，其子节点必为黑色
5. 对于任意节点该节点到任意后代的叶结点的黑色节点数目相同，即所谓"黑高"一致

通过构建平衡二叉树与红黑树的对比可以看到两者的差异，假如当前要插入一组整型数据如：11，2，14，1，7，15，5，8，4
如果构建的是平衡二叉树，插入数据后生成的二叉树如下图：

![image.png](/.attachments/image-220ff11c-d1f4-4c77-8fc0-494e9b042e8a.png)

如果构建的是红黑树，插入数据后生成的二叉树如下图：(这里面图黑的就是黑节点，未图颜色的就是红色节点)

![image.png](/.attachments/image-1e12069b-24e2-437a-8f37-dd21361fb7e8.png)

通过两者的对比你就会发现红黑树的平衡性是完全好于一般的平衡二叉树的，那问题是如何构建红黑树，这里就涉及到两个难点一个是插入的实现，另一个是删除的实现，其中删除的情况要更为复杂

##红黑树的插入
依据之前构建的红黑树，来讲一下构建该红黑树的过程，如下图
![image.png](/.attachments/image-d64992bd-6fec-4c4b-a167-87428aac3039.png)

你能看到每一次的插入，红黑树为了维护自身的性质1，2会不断的去改变节点颜色，但是当前的操作即使维护了**性质1**与**性质2**，但是却无法维护**性质4**，此刻你也能注意到**性质4**的破坏是由于插入4迫使其父节点与叔父节点为了维护**性质4**做出改变，但是即使如此**性质4**依然没有修复但是此时插入操作已经结束，此刻需要用到**左旋**与**右旋**操作

# 左旋与右旋
所谓左旋就是指二叉树中在右侧的子节点"向左侧旋转"变成父节点,而原来的父节点会变为当前父节点的左侧子节点效果如下图

![image.png](/.attachments/image-22a5748f-6669-4cf6-ad82-af778c56f769.png)

此刻7变成父节点，但是5以下原来是7的左子树，为了维护二叉树的性质因此原来7的左子树变为当前2的右子树如下图

![image.png](/.attachments/image-fa73455d-9c9a-4476-9e6c-a0461fd8b102.png)

右旋与左旋恰好完全相反，根据左旋的概念就可以推导出右旋

# 基于左旋与右旋的变换
回到刚才的红黑树，我们已经知道此时插入数据已经结束了，但是该红黑树的**性质3**被破坏了，我们可看到当前的红黑树2，7是连续的红节点，如果再对其任一节点进行染色虽然可以恢复**性质3**，但是却破坏了**性质5**

![image.png](/.attachments/image-699a4adb-c410-436e-98e2-9afef5187dc2.png)

此刻对7进行左旋，如下图

![image.png](/.attachments/image-e05c30c4-07fc-4a14-a876-4e52987300f8.png)

可以看出来当前只是变换了其位置，但是如果交换了2，11的颜色呢

![image.png](/.attachments/image-1e97a3e2-8781-4788-86c3-a8bff4b218d7.png)

能看出来**性质4**得到了修复，但是却破坏了**性质1**与**性质5**,侧刻为了修复性质1，再对7进行右侧旋
![image.png](/.attachments/image-bb33656a-df96-473b-af16-ea006cf2437a.png)

此时，通过上述操作红黑的构建就完成了

# 对左旋与右旋操作的分析
针对刚才的二叉再执行完插入数据的操作后，我们针对节点**7**做了**左旋**，**与父节点交换颜色**，**右旋**,但是构建红黑树一定要这样做吗？如果尝试用其它的方式是否可行，我们可以做出如下假设：

1. 将**节点2**染黑
如果染黑**节点2**，那么如下图
![image.png](/.attachments/image-b6c718b7-c502-4c7f-a129-2265bb9a406a.png)